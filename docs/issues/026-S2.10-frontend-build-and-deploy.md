---
id: S2.10
title: "Frontend build & deploy (Vite + Env)"
epic: "E3 - Deploy & Ops"
sprint: "Sprint 2"
estimate: 3
labels: ["frontend", "deploy", "docs", "sprint-2"]
assignees: ["fe1"]
dependencies: ["S1.5", "S2.5", "S2.7"]
status: "open"
---

## Context
Chuẩn hoá quy trình build và triển khai FE (React + Vite). Đảm bảo biến môi trường đúng cho Solana + Indexer, tạo artifact tĩnh `dist/`, và hướng dẫn triển khai (Vercel/Netlify/Nginx).

## Scope
- Thiết lập `.env.production` cho FE (Solana + Indexer)
- Build sản phẩm (`pnpm build`) và smoke test (`vite preview`)
- Hướng dẫn triển khai: Vercel/Netlify/Nginx (tĩnh)
- Cấu hình CORS/URL Indexer trong FE

## Acceptance Criteria
- Chạy `pnpm build` sinh thư mục `frontend/dist` không lỗi
- `vite preview` chạy OK, kết nối ví Solana và gọi Indexer thành công
- Biến môi trường dùng đúng (không hardcode trong source)
- Tài liệu triển khai rõ ràng (Các tuỳ chọn hosting tĩnh)

## Tasks
- Tạo `frontend/.env.production` với các biến tối thiểu:
  - `VITE_SOLANA_CLUSTER`
  - `VITE_PROGRAM_ID`
  - `VITE_SOLANA_RPC_URL`
  - `VITE_INDEXER_URL` (ví dụ: `http://localhost:3001` hoặc domain prod)
  - `VITE_STAKE_LAMPORTS`
- Cập nhật README hướng dẫn chọn RPC (public vs Helius) và mapping cluster
- Build và smoke test:
  - `pnpm --filter frontend build`
  - `pnpm --filter frontend preview`
  - Kiểm tra: kết nối ví, hiển thị round, leaderboard fetch OK
- Tối ưu build: bật source map prod (nếu cần debug), kiểm tra base path
- Triển khai (chọn 1 hoặc nhiều):
  - Vercel/Netlify: upload `dist/`
  - Nginx: serve `frontend/dist` (kèm cấu hình fallback `try_files`)
- Viết mục "Deploy Frontend" trong `frontend/README.md` (liên kết tới `.env.example`)

## Out of Scope
- PWA/Service Worker, SSR/ISR
- EVM legacy flow (giữ biến môi trường để back-compat)

## Notes
- FE đang dùng Vite + React, Tailwind; build script: `tsc -b && vite build`
- API Indexer: đặt qua `VITE_INDEXER_URL` để tách biệt môi trường

