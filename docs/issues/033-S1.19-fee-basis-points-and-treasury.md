---
id: S1.19
title: "Fee basis points & Treasury (tham số + an toàn số học)"
epic: "E1 - Smart Contract Core"
sprint: "Sprint 1"
estimate: 3
labels: ["contract", "fees", "sprint-1"]
assignees: ["be1"]
dependencies: ["S1.2"]
status: "done"
---

## Context
Thiết lập tham số fee theo basis points (bps) và địa chỉ Treasury; đảm bảo tính toán an toàn, không vượt Total, làm tròn hợp lý.

## Scope
- Lưu `feeBps` và `treasury`
- Ràng buộc `feeBps ≤ 10000`
- Tính `Fee = bps/10000 × Total` an toàn số học
- Kiểm thử rounding, edge cases

## Acceptance Criteria
- Fee luôn ≤ Total; treasury nhận đúng số
- Tham số hợp lệ, có thể cập nhật cho round tiếp theo (admin)

## Tasks
- [ ] Thêm trường và validations
- [ ] Helper tính fee an toàn
- [ ] Unit tests: rounding/edge cases

## Test Cases
- `feeBps=0`, `feeBps=10000`
- Pool lệch/bằng nhau

## Tham chiếu thiết kế
- § 4 (Fee), § 7.6 (Payout & fee)

